{"componentChunkName":"component---src-templates-policy-detail-page-tsx","path":"/AmazonGuardDutyMalwareProtectionServiceRolePolicy/","result":{"data":{"allPolicyMetadata":{"nodes":[{"services":["ec2","ecs","eks","kms","logs","ebs"],"actions":["ebs:GetSnapshotBlock","ebs:ListSnapshotBlocks","ec2:CreateSnapshot","ec2:CreateTags","ec2:DeleteSnapshot","ec2:DescribeInstances","ec2:DescribeSnapshots","ec2:DescribeVolumes","ec2:ModifySnapshotAttribute","ecs:DescribeTasks","ecs:ListClusters","ecs:ListContainerInstances","ecs:ListTasks","eks:DescribeCluster","kms:CreateGrant","kms:DescribeKey","kms:ReEncryptFrom","kms:ReEncryptTo","logs:CreateLogGroup","logs:CreateLogStream","logs:DescribeLogGroups","logs:DescribeLogStreams","logs:PutLogEvents","logs:PutRetentionPolicy"],"policy":{"PolicyName":"AmazonGuardDutyMalwareProtectionServiceRolePolicy","PolicyId":"ANPAZKAPJZG4DYKRPKYEO","Arn":"arn:aws:iam::aws:policy/aws-service-role/AmazonGuardDutyMalwareProtectionServiceRolePolicy","Path":"/aws-service-role/","DefaultVersionId":"v2","AttachmentCount":0,"PermissionsBoundaryUsageCount":0,"IsAttachable":true,"Description":"GuardDuty malware protection uses the service-linked role (SLR) named AWSServiceRoleForAmazonGuardDutyMalwareProtection. This service-linked role allows GuardDuty malware protection to perform agent-less scans to detect malware. It allows GuardDuty to create snapshots in your account, and share the snapshots with the GuardDuty service account to scan for malware. It evaluates these shared snapshots and includes the retrieved EC2 instance metadata in the GuardDuty Malware Protection findings. The AWSServiceRoleForAmazonGuardDutyMalwareProtection service-linked role trusts the malware-protection.guardduty.amazonaws.com service to assume the role.","CreateDate":"2022-07-19T19:06:53.000Z","UpdateDate":"2024-01-25T22:24:00.000Z"},"document":[{"Effect":"Allow","Action":["ec2:DescribeInstances","ec2:DescribeVolumes","ec2:DescribeSnapshots","ecs:ListClusters","ecs:ListContainerInstances","ecs:ListTasks","ecs:DescribeTasks","eks:DescribeCluster"],"Resource":["*"]},{"Effect":"Allow","Action":["ec2:CreateSnapshot"],"Resource":["arn:aws:ec2:*:*:volume/*"]},{"Effect":"Allow","Action":["ec2:CreateSnapshot"],"Resource":["arn:aws:ec2:*:*:snapshot/*"]},{"Effect":"Allow","Action":["ec2:CreateTags"],"Resource":["arn:aws:ec2:*:*:*/*"]},{"Effect":"Allow","Action":["ec2:CreateTags"],"Resource":["arn:aws:ec2:*:*:snapshot/*"]},{"Effect":"Allow","Action":["ec2:DeleteSnapshot","ec2:ModifySnapshotAttribute"],"Resource":["arn:aws:ec2:*:*:snapshot/*"]},{"Effect":"Deny","Action":["ec2:ModifySnapshotAttribute"],"Resource":["arn:aws:ec2:*:*:snapshot/*"]},{"Effect":"Allow","Action":["kms:CreateGrant"],"Resource":["arn:aws:kms:*:*:key/*"]},{"Effect":"Allow","Action":["kms:ReEncryptTo","kms:ReEncryptFrom"],"Resource":["arn:aws:kms:*:*:key/*"]},{"Effect":"Allow","Action":["kms:DescribeKey"],"Resource":["arn:aws:kms:*:*:key/*"]},{"Effect":"Allow","Action":["logs:DescribeLogGroups","logs:CreateLogGroup","logs:PutRetentionPolicy"],"Resource":["arn:aws:logs:*:*:log-group:/aws/guardduty/*"]},{"Effect":"Allow","Action":["logs:CreateLogStream","logs:PutLogEvents","logs:DescribeLogStreams"],"Resource":["arn:aws:logs:*:*:log-group:/aws/guardduty/*:log-stream:*"]},{"Effect":"Allow","Action":["ebs:GetSnapshotBlock","ebs:ListSnapshotBlocks"],"Resource":["arn:aws:ec2:*:*:snapshot/*"]}]}]}},"pageContext":{"PolicyName":"AmazonGuardDutyMalwareProtectionServiceRolePolicy"}},"staticQueryHashes":["256249292"],"slicesMap":{}}